uid: wp_schedule
tags: []
props:
  parameters:
    - context: item
      description: group containing all heating-items
      label: heating group
      name: heatGroup
      required: false
      type: TEXT
    - context: item
      description: The heating circuit being edited (0..3)
      label: heating circuit
      name: circuit
      required: false
      type: TEXT
    - context: item
      description: Day of actual JSON Array
      label: day of the schedule time pairs
      name: dayOfWeek
      required: false
      type: TEXT
    - context: item
      description: JSON Array for Heating Times
      label: heating pairs
      name: timesArray
      required: false
      type: TEXT
    - context: item
      description: type of the aktual schedule
      label: aktual schedule
      name: scheduleType
      required: false
      type: TEXT
    - context: Text
      label: scheduleColorScheme
      name: scheduleColorScheme
      required: true
      type: TEXT
  parameterGroups: []
timestamp: Feb 24, 2026, 5:40:27 PM
component: f7-block
config:
  class:
    - margin-horizontal-half
    - no-margin-top
    - no-padding
  style:
    height: auto
slots:
  default:
    - component: f7-row
      config:
        class:
          - justify-content-center
        style:
          background-color: =props.scheduleColorScheme
      slots:
        default:
          - component: Label
            config:
              style:
                font-size: 18px
                font-weight: 700
              text: "=(dayjs().format('dddd').includes('tag'))? 'Zeitprogramm für :
                '+({mon:'Montag',tue:'Dienstag',wed:'Mittwoch',thu:'Donnerstag'\
                ,fri:'Freitag',sat:'Samstag',sun:'Sonntag'})[props.dayOfWeek]:
                'Schedule for :
                '+({mon:'Monday',tue:'Tuesday',wed:'Wednesday',thu:'Thursday',f\
                ri:'Friday',sat:'Saturday',sun:'Sunday'})[props.dayOfWeek]"
    - component: f7-row
      config:
        class:
          - justify-content-space-between
        style:
          font-size: 12px
          font-weight: 400
          line-height: 12px
      slots:
        default:
          - component: Label
            config:
              text: 00:00
          - component: Label
            config:
              text: 06:00
          - component: Label
            config:
              text: 12:00
          - component: Label
            config:
              text: 18:00
          - component: Label
            config:
              text: 24:00
    - component: f7-row
      config:
        class:
          - display-flex
          - flex-direction-row
          - justify-content-space-between
        style:
          line-height: 12px
      slots:
        default:
          - component: oh-repeater
            config:
              for: i
              fragment: true
              rangeStart: 0
              rangeStep: 1
              rangeStop: 24
              sourceType: range
            slots:
              default:
                - component: Label
                  config:
                    class:
                      - display-flex
                      - no-margin
                      - no-padding
                      - text-align-left
                    style:
                      font-size: =(loop.i==0||loop.i==6||loop.i==12||loop.i==18||loop.i==24)?"10px":"10px"
                      font-weight: =(loop.i==0||loop.i==6||loop.i==12||loop.i==18||loop.i==24)?"700":"300"
                    text: ="|"
    - component: f7-row
      config:
        class:
          - margin-bottom-half
          - no-padding
          - text-align-center
        style:
          display: grid
          font-size: 12px
          font-weight: 700
          gap: 5px
          grid-template-columns: repeat(5, 1fr)
          line-height: 20px
      slots:
        default:
          - component: f7-segmented
            config:
              class:
                - segmented
              style:
                --f7-button-bg-color: =props.buttonBgColor
                --f7-button-border-radius: 2px
                --f7-button-fill-bg-color: var(--f7-theme-color)
                --f7-button-font-size: 8px
                --f7-button-font-weight: 300
                --f7-button-hover-bg-color: rgba(=props.buttonBgColor, 0.07) !important
                --f7-button-outline-border-width: 1px
                --f7-button-padding-horizontal: 0px
                --f7-button-padding-vertical: 5px
                --f7-button-text-color: var(--f7-theme-color)
                grid-column-start: span 5
                height: 24px
                width: 100%
            slots:
              default:
                - component: oh-repeater
                  config:
                    class:
                      - programModes
                    for: pM
                    fragment: true
                    in: =props.timesArray
                    rangeStart: 0
                    rangeStop: =(loop.pM_source.length)-1
                    sourceType: array
                  slots:
                    default:
                      - component: oh-repeater
                        config:
                          for: pT
                          fragment: true
                          rangeStart: 0
                          rangeStop: =(loop.pM_source.length*2)
                          sourceType: range
                          style:
                            height: 100%
                            width: 100%
                        slots:
                          default:
                            - component: oh-context
                              config:
                                constants:
                                  cC: hsl(0,100%,50%)
                                  cN: hsl(0,100%,80%)
                                  cOff: hsl(0,0%,50%)
                                  cOn: hsl(20,100%,60%)
                                  cR: hsl(0,100%,95%)
                                  end: '=(loop.pT==0)?Number(0).toString(): Math.ceil(
                                    Number((loop.pM_source[(Math.ceil(loop.pT/2)-1)]["end"].split(":")[0])*60)+Number((loop.pM_source[(Math.ceil(loop.pT/2)-1)]["end"].split(":")[1])))'
                                  mode: =((loop.pT_idx/2).toString()-Math.floor((loop.pT_idx/2).toString()))?loop.pM_source[Math.floor(loop.pT_idx/2)]["mode"]:"standby"
                                  start: '=((loop.pT)==(loop.pM_source.length*2))?Number(24*60):
                                    Math.round(Number((loop.pM_source[Math.floor(loop.pT/2)]["start"].split(":")[0])*60)+Number((loop.pM_source[Math.floor(loop.pT/2)]["start"].split(":")[1])))'
                              slots:
                                default:
                                  - component: oh-button
                                    config:
                                      outline: true
                                      small: true
                                      style:
                                        background: '=(props.scheduleType=="HZ")?"url("+"/static/waermepumpe/heat"+((const.mode=="normal")?"2":(const.mode=="comfort")?"3":"1")+".svg)":
                                          (props.scheduleType=="WW")?(const.mode=="on")?"url(/static/waermepumpe/ww-heat1.svg)":"":
                                          (props.scheduleType=="ZI")?(const.mode=="on")?"url(/static/waermepumpe/zirkulation-rounded.svg)":"":""'
                                        background-color: '=(props.scheduleType=="HZ")?((const.mode=="normal")?const.cN:(const.mode=="comfort")?const.cC:const.cR):
                                          (props.scheduleType=="WW")?((const.mode=="on")?const.cOn:const.cOff):
                                          (props.scheduleType=="ZI")?((const.mode=="on")?const.cOn:const.cOff):""'
                                        background-position: center
                                        background-repeat: no-repeat
                                        background-size: 20px
                                        borderColor: =props.scheduleColorScheme
                                        color: black
                                        font-size: 12px
                                        height: 24px
                                        width: =((loop.pT%2)=="0")?((const.start-const.end)/1440*100)+"%":((const.end-const.start)/1440*100)+"%"
                                      visible: =(loop.pM_idx==0)
    - component: oh-repeater
      config:
        for: modes
        fragment: true
        rangeStart: 0
        rangeStep: 1
        rangeStop: =props.timesArray.length-1
        sourceType: range
      slots:
        default:
          - component: oh-button
            config:
              class:
                - display-flex
                - margin-vertical-half
                - no-padding
              style:
                height: 30px
                width: 100%
              visible: =(props.timesArray!=undefined)&&(loop.modes<=(props.timesArray.length)-1)
            slots:
              default:
                - component: oh-link
                  config:
                    action: popup
                    class:
                      - no-margin
                    popupOpen: ="."+"wp-schedule-setter"+loop.modes
                    style:
                      flex-grow: 1
                      with: 100%
                  slots:
                    default:
                      - component: f7-row
                        config:
                          class:
                            - no-margin
                            - align-items-center
                            - justify-content-left
                          style:
                            background-color: lightgray
                            color: black
                            height: 40px
                            width: 100%
                        slots:
                          default:
                            - component: f7-chip
                              config:
                                style:
                                  --f7-chip-bg-color: '=(props.timesArray[loop.modes]["mode"]=="normal")?"hsl(0,100%,80%)":
                                    (props.timesArray[loop.modes]["mode"]=="comfort")?"hsl(0,100%,50%)":
                                    (props.timesArray[loop.modes]["mode"]=="on")?"hsl(20,100%,60%)":""'
                                  height: 24px
                                  margin-left: 5px
                                  padding: 5px
                                  width: 3px
                            - component: oh-icon
                              config:
                                icon: '=(props.timesArray[loop.modes]["mode"]=="normal")?"oh:heat2":
                                  (props.timesArray[loop.modes]["mode"]=="comfort")?"oh:heat3":
                                  (props.timesArray[loop.modes]["mode"]=="on")?(props.scheduleType=="WW")?"oh:ww-heat":"oh:ww-zirkulation":""'
                                iconColor: white
                                style:
                                  color: white
                                  margin-left: 5px
                                  text-align: left
                                width: 28px
                            - component: Label
                              config:
                                style:
                                  flex-grow: 1
                                  padding-left: 10px
                                  text-align: left
                                  text-transform: capitalize
                                text: =(props.timesArray[loop.modes]["mode"])
                            - component: Label
                              config:
                                style:
                                  margin-right: 5px
                                text: =props.timesArray[loop.modes]["start"]+"-"+props.timesArray[loop.modes]["end"]
                            - component: oh-icon
                              config:
                                icon: f7:chevron_down
                                iconColor: black
                                iconSize: 8px
                                style:
                                  margin-right: 5px
                      - component: f7-popup
                        config:
                          backdrop: true
                          class: ="wp-schedule-setter"+loop.modes
                          closeByBackdropClick: true
                          closeByOutsideClick: true
                          closeOnEscape: true
                          style:
                            --f7-popup-border-radius: 1px
                        slots:
                          default:
                            - component: widget:wp_schedule_setter
                              config:
                                group: =props.heatGroup
                                circuit: =props.circuit
                                timeNr: =Number.parseInt(loop.modes+1).toString()
                                timesCount: =Number.parseInt(props.timesArray.length)
                                scheduleKind: =props.scheduleType
                                title: "=(dayjs().format('dddd').includes('tag'))? 'Zeitpaar bearbeiten
                                  (Nr:'+Number.parseInt(loop.modes+1)+')': 'Edit
                                  time pair
                                  (Nr:'+Number.parseInt(loop.modes+1)+')'"
                                setterColorScheme: =props.scheduleColorScheme
    - component: f7-row
      config:
        class:
          - display-flex
          - justify-content-flex-end
          - margin-bottom
      slots:
        default:
          - component: oh-button
            config:
              action: popup
              class:
                - display-flex
                - justify-items-center
                - text-align-center
              fill: true
              iconColor: black
              iconF7: plus_circle_fill
              iconSize: 24px
              outline: true
              popupOpen: ="."+"wp-schedule-setter"+Number.parseInt(props.timesArray.length)
              raised: true
              round: true
              style:
                --f7-button-border-color: =props.scheduleColorScheme
                --f7-button-fill-bg-color: =props.scheduleColorScheme
                color: black
                height: 29px
                width: auto
              text: =(dayjs().format('dddd').includes('tag'))?'Neues Zeitpaar':'New time pair'
            slots:
              default:
                - component: f7-popup
                  config:
                    backdrop: true
                    class: ="wp-schedule-setter"+Number.parseInt(props.timesArray.length)
                    closeByBackdropClick: true
                    closeByOutsideClick: true
                    closeOnEscape: true
                    style:
                      --f7-popup-border-radius: 1px
                  slots:
                    default:
                      - component: widget:wp_schedule_setter
                        config:
                          group: =props.heatGroup
                          circuit: =props.circuit
                          timeNr: =Number.parseInt(props.timesArray.length+1)
                          timesCount: =Number.parseInt(props.timesArray.length)
                          scheduleKind: =props.scheduleType
                          title: "=(dayjs().format('dddd').includes('tag'))? 'Zeitpaar hinzufügen
                            (Nr:'+Number.parseInt(props.timesArray.length+1)+')\
                            ': 'Add time pair
                            (Nr:'+Number.parseInt(props.timesArray.length+1)+')\
                            '"
                          setterColorScheme: =props.scheduleColorScheme
