uid: wp_Tab2
tags: []
props:
  parameters:
    - default: ViessmannWaermepumpe
      description: Die Gruppe der Waermepumpe
      label: Heatpump Group
      name: heatGroup
      required: false
      type: TEXT
    - context: item
      description: An item to control
      label: Item
      name: item
      required: false
      type: TEXT
    - context: Text
      default: orange
      label: ColorScheme
      name: colorScheme
      required: true
      type: TEXT
    - context: Text
      default: rgb(255, 165, 0)
      label: Hex ColorScheme
      name: hexColorScheme
      required: true
      type: TEXT
  parameterGroups: []
timestamp: Jan 22, 2026, 10:58:44 PM
component: f7-block
config:
  class:
    - margin-horizontal-half
    - no-margin-vertical
    - no-padding
  key: =@(props.heatGroup+"_Heating_schedule_Circuit_1")
slots:
  default:
    - component: f7-block
      config:
        class:
          - xno-margin-vertical
          - no-padding
          - text-align-center
        style:
          margin: 2px 0px 2px 0px
          display: grid
          font-size: 11px
          font-weight: 700
          gap: 5px
          grid-template-columns: repeat(4, 1fr)
          line-height: 12px
      slots:
        default:
          - component: Label
            config:
              text: Heizung
          - component: Label
            config:
              text: Reduziert
          - component: Label
            config:
              text: Normal
          - component: Label
            config:
              text: Komfort
          - component: oh-button
            config:
              action: toggle
              actionCommand: heating
              actionCommandAlt: standby
              actionItem: =props.heatGroup+"_Operating_mode__active_Circuit_1"
              outline: true
              small: true
              style:
                background-color: gray
                xborderColor: lightgray
                color: black
                display: flex
                font-size: 11px
                padding-left: 3px
                padding-right: 3px
                text-transform: uppercase
                borderColor: =props.colorScheme
                border-radius: 4px
            slots:
              default:
                - component: oh-icon
                  config:
                    color: =(@(props.heatGroup+"_Operating_mode__active_Circuit_1")=="Heating")?"green":"red"
                    icon: f7:power
                    style:
                      flex-grow: 1
                      font-size: 18px
                      text-align: left
                - component: Label
                  config:
                    text: =@(props.heatGroup+"_Operating_mode__active_Circuit_1")
                - component: oh-icon
                  config:
                    height: 14px
                    icon: f7:chevron_down
          - component: oh-button
            config:
              action: popover
              outline: true
              popoverOpen: ="."+props.heatGroup+"_heatingcircuitsNoperatingprogramsreducedHeating_Circuit_1_temperature"
              small: true
              style:
                background: url("/static/waermepumpe/heat1.svg")
                background-color: hsl(0,100%,95%)
                background-repeat: no-repeat
                background-size: 23px
                background-position: 5px 0px
                xborderColor: lightgray
                color: black
                display: flex
                justify-content: right
                padding-right: 3px
                borderColor: =props.colorScheme
                border-radius: 4px
            slots:
              default:
                - component: Label
                  config:
                    text: =items[props.heatGroup+"_heatingcircuitsNoperatingprogramsreducedHeating_Circuit_1_temperature"].numericState+"°"
                - component: oh-icon
                  config:
                    height: 14px
                    icon: f7:chevron_down
                - component: f7-popover
                  config:
                    backdrop: false
                    class: =props.heatGroup+"_heatingcircuitsNoperatingprogramsreducedHeating_Circuit_1_temperature"
                    closeByBackdropClick: true
                    closeByOutsideClick: true
                    closeOnEscape: true
                    style:
                      --f7-popover-border-radius: 5px
                      --f7-popover-width: 180px
                  slots:
                    default:
                      - component: widget:wp_value_setter
                        config:
                          item: =props.heatGroup+"_heatingcircuitsNoperatingprogramsreducedHeating_Circuit_1_temperature"
                          type: Temperatur für Niveau Reduziert
          - component: oh-button
            config:
              action: popover
              outline: true
              popoverOpen: ="."+props.heatGroup+"_heatingcircuitsNoperatingprogramsnormalHeating_Circuit_1_temperature"
              small: true
              style:
                background: url("/static/waermepumpe/heat2.svg")
                background-color: hsl(0,100%,80%)
                background-repeat: no-repeat
                background-size: 23px
                background-position: 5px 0px
                xborderColor: lightgray
                color: black
                display: flex
                justify-content: right
                padding-right: 3px
                borderColor: =props.colorScheme
                border-radius: 4px
            slots:
              default:
                - component: Label
                  config:
                    text: =items[props.heatGroup+"_heatingcircuitsNoperatingprogramsnormalHeating_Circuit_1_temperature"].numericState+"°"
                - component: oh-icon
                  config:
                    height: 14px
                    icon: f7:chevron_down
                - component: f7-popover
                  config:
                    backdrop: false
                    class: =props.heatGroup+"_heatingcircuitsNoperatingprogramsnormalHeating_Circuit_1_temperature"
                    closeByBackdropClick: true
                    closeByOutsideClick: true
                    closeOnEscape: true
                    style:
                      --f7-popover-border-radius: 5px
                      --f7-popover-width: 180px
                  slots:
                    default:
                      - component: widget:wp_value_setter
                        config:
                          item: =props.heatGroup+"_heatingcircuitsNoperatingprogramsnormalHeating_Circuit_1_temperature"
                          type: Temperatur für Niveau Normal
                          ytype: Normal
          - component: oh-button
            config:
              action: popover
              outline: true
              popoverOpen: ="."+props.heatGroup+"_heatingcircuitsNoperatingprogramscomfortHeating_Circuit_1_temperature"
              small: true
              style:
                background: url("/static/waermepumpe/heat3.svg")
                background-color: hsl(0,100%,50%)
                background-repeat: no-repeat
                background-size: 23px
                background-position: 5px 0px
                xborderColor: lightgray
                color: black
                display: flex
                justify-content: right
                padding-right: 3px
                borderColor: =props.colorScheme
                border-radius: 4px
            slots:
              default:
                - component: Label
                  config:
                    text: =items[props.heatGroup+"_heatingcircuitsNoperatingprogramscomfortHeating_Circuit_1_temperature"].numericState+"°"
                - component: oh-icon
                  config:
                    height: 14px
                    icon: f7:chevron_down
                    xiconColor: black
                - component: f7-popover
                  config:
                    backdrop: false
                    class: =props.heatGroup+"_heatingcircuitsNoperatingprogramscomfortHeating_Circuit_1_temperature"
                    closeByBackdropClick: true
                    closeByOutsideClick: true
                    closeOnEscape: true
                    style:
                      --f7-popover-border-radius: 5px
                      --f7-popover-width: 180px
                  slots:
                    default:
                      - component: widget:wp_value_setter
                        config:
                          item: =props.heatGroup+"_heatingcircuitsNoperatingprogramscomfortHeating_Circuit_1_temperature"
                          type: Temperatur für Niveau Komfort
    - component: f7-block
      config:
        class:
          - no-margin-vertical
          - no-padding
          - text-align-center
        style:
          display: grid
          font-size: 12px
          font-weight: 700
          gap: 3px
          grid-template-columns: 24px repeat(4, 1fr)
          line-height: 13px
      slots:
        default:
          - component: Label
            config:
              style:
                grid-column: 1 / span 5
              text: Zeitprogramm Heizen
          - component: widget:wp_timeaxis
          - component: oh-repeater
            config:
              class:
                - wochenTag
              for: weekDay
              fragment: true
              in:
                - mon
                - tue
                - wed
                - thu
                - fri
                - sat
                - sun
              map: ({"key":loop.weekDay,"value":JSON.parse(@@("ViessmannWaermepumpe_Heating_schedule_Circuit_1"))[loop.weekDay]})
              sourceType: array
            slots:
              default:
                - component: Label
                  config:
                    class:
                      - objectlabel
                    style:
                      grid-column-start: 1
                      line-height: 24px
                    text: =({mon:"Mo",tue:"Di",wed:"Mi",thu:"Do",fri:"Fr",sat:"Sa",sun:"So"})[loop.weekDay.key]
                - component: f7-segmented
                  config:
                    class:
                      - segmented
                    style:
                      --f7-button-border-radius: 2px
                      --f7-button-font-size: 8px
                      --f7-button-font-weight: 300
                      --f7-button-outline-border-width: 1px
                      --f7-button-padding-horizontal: 0px
                      --f7-button-text-color: var(--f7-theme-color)
                      grid-column-start: span 4
                      height: 24px
                  slots:
                    default:
                      - component: oh-button
                        config:
                          action: rule
                          actionRule: Heatpump_Populate_ProxyItems
                          actionRuleContext:
                            group: =props.heatGroup
                            timesArray: =loop.weekDay.value
                            whichSched: HZ
                            wochenTag: =loop.weekDay.key
                          outline: true
                          style:
                            --f7-button-border-color: gray
                            height: 22px
                            padding: 0px
                            x--f7-button-border-color: =props.colorScheme
                        slots:
                          default:
                            - component: oh-repeater
                              config:
                                class:
                                  - programModes
                                for: pM
                                fragment: true
                                in: =loop.weekDay.value
                                rangeStart: 0
                                rangeStop: =(loop.pM_source.length)-1
                                sourceType: array
                                style:
                                  height: 100%
                                  width: 100%
                              slots:
                                default:
                                  - component: oh-repeater
                                    config:
                                      for: pT
                                      fragment: true
                                      rangeStart: 0
                                      rangeStop: =(loop.pM_source.length*2)
                                      sourceType: range
                                    slots:
                                      default:
                                        - component: oh-context
                                          config:
                                            constants:
                                              cC: hsl(0,100%,50%)
                                              cN: hsl(0,100%,80%)
                                              cR: hsl(0,100%,95%)
                                              end: '=(loop.pT==0)?Number(0).toString(): Math.round(
                                                Number((loop.pM_source[(Math.ceil(loop.pT/2)-1)]["end"].split(":")[0])*60)+Number((loop.pM_source[(Math.ceil(loop.pT/2)-1)]["end"].split(":")[1])))'
                                              mode: =((loop.pT_idx/2).toString()-Math.floor((loop.pT_idx/2).toString()))?loop.pM_source[Math.floor(loop.pT_idx/2)]["mode"]:"standby"
                                              start: '=((loop.pT)==(loop.pM_source.length*2))?Number(24*60):
                                                Math.round(Number((loop.pM_source[Math.floor(loop.pT/2)]["start"].split(":")[0])*60)+Number((loop.pM_source[Math.floor(loop.pT/2)]["start"].split(":")[1])))'
                                          slots:
                                            default:
                                              - component: oh-link
                                                config:
                                                  action: sheet
                                                  actionModal: widget:wp_schedule
                                                  actionModalConfig:
                                                    colorScheme: =props.colorScheme
                                                    scheduleType: HZ
                                                    timesArray: =loop.weekDay.value
                                                    wochenTag: =loop.weekDay.key
                                                  atext: =const.start
                                                  outline: true
                                                  sheetClose: false
                                                  small: true
                                                  style:
                                                    abackground-position: center
                                                    background: ="url("+"/static/waermepumpe/heat"+((const.mode=="normal")?"2":(const.mode=="comfort")?"3":"1")+".svg)"
                                                    background-color: =(const.mode=="normal")?const.cN:(const.mode=="comfort")?const.cC:const.cR
                                                    background-position: left
                                                    background-repeat: no-repeat
                                                    background-size: 20px
                                                    borderColor: =props.colorScheme
                                                    color: black
                                                    font-size: 12px
                                                    height: 22px
                                                    width: =((loop.pT%2)=="0")?((const.start-const.end)/1440*100)+"%":((const.end-const.start)/1440*100)+"%"
                                                  visible: =(loop.pM_idx==0)
